<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Contact Privacy Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #f8fafc;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
        }
        .status-confirmed { background-color: #dcfce7; color: #166534; }
        .status-pending { background-color: #fef3c7; color: #92400e; }
        .status-completed { background-color: #e0e7ff; color: #3730a3; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Calendar, Clock, MapPin, User, Phone, Mail, MessageSquare, CheckCircle, XCircle, AlertCircle, Edit, Archive, AlertTriangle, FileText, Ban, Search } = lucide;

        // Mock meeting data with contact information
        const mockMeetings = [
            {
                id: "meeting_001",
                purchaseId: "purchase_001",
                buyerId: "buyer_123",
                sellerId: "seller_456",
                buyerName: "John Smith",
                sellerName: "Alice Johnson",
                gemName: "Blue Sapphire Ring",
                gemType: "Sapphire",
                finalPrice: 25000,
                primaryImageUrl: "https://images.unsplash.com/photo-1544737151406-6aec4d3a5b6e?w=400",
                proposedDateTime: "2025-01-15T14:00:00Z",
                confirmedDateTime: "2025-01-15T14:00:00Z",
                location: "Gem Palace, Colombo 03",
                meetingType: "IN_PERSON",
                status: "CONFIRMED",
                buyerNotes: "Looking forward to seeing the gem in person",
                sellerNotes: "Will bring certification documents",
                buyerContact: {
                    fullName: "John Smith",
                    email: "john.smith@email.com",
                    phoneNumber: "+94 77 123 4567"
                },
                sellerContact: {
                    fullName: "Alice Johnson",
                    email: "alice.johnson@gems.lk",
                    phoneNumber: "+94 71 987 6543"
                },
                createdAt: "2025-01-10T10:00:00Z",
                updatedAt: "2025-01-12T15:30:00Z",
                meetingDisplayId: "MTG-001"
            },
            {
                id: "meeting_002",
                purchaseId: "purchase_002",
                buyerId: "buyer_789",
                sellerId: "seller_101",
                buyerName: "Michael Brown",
                sellerName: "Sarah Davis",
                gemName: "Ruby Necklace",
                gemType: "Ruby",
                finalPrice: 45000,
                primaryImageUrl: "https://images.unsplash.com/photo-1515562141207-7a88fb7ce338?w=400",
                proposedDateTime: "2025-01-20T11:00:00Z",
                location: "Central Gem Market, Ratnapura",
                meetingType: "IN_PERSON",
                status: "PENDING",
                buyerNotes: "Interested in the craftsmanship details",
                buyerContact: {
                    fullName: "Michael Brown",
                    email: "michael.brown@email.com",
                    phoneNumber: "+94 76 555 1234"
                },
                sellerContact: {
                    fullName: "Sarah Davis",
                    email: "sarah.davis@goldsmith.lk",
                    phoneNumber: "+94 72 444 5678"
                },
                createdAt: "2025-01-11T09:00:00Z",
                updatedAt: "2025-01-11T09:00:00Z",
                meetingDisplayId: "MTG-002"
            }
        ];

        const ContactPrivacyTest = () => {
            const [viewType, setViewType] = useState('buyer');
            const [selectedMeeting, setSelectedMeeting] = useState(mockMeetings[0]);

            const formatCurrency = (amount) => {
                return new Intl.NumberFormat('en-LK', {
                    style: 'currency',
                    currency: 'LKR'
                }).format(amount);
            };

            const formatDateTime = (dateTimeString) => {
                const date = new Date(dateTimeString);
                return {
                    date: date.toLocaleDateString('en-GB'),
                    time: date.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' })
                };
            };

            const isUserSeller = (meeting) => {
                return viewType === 'seller';
            };

            const renderMeetingCard = (meeting) => {
                const isSeller = isUserSeller(meeting);
                const datetime = formatDateTime(meeting.confirmedDateTime || meeting.proposedDateTime);

                return (
                    <div key={meeting.id} className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-4">
                        <div className="flex items-start justify-between mb-4">
                            <div className="flex items-start space-x-4">
                                <img
                                    src={meeting.primaryImageUrl}
                                    alt={meeting.gemName}
                                    className="w-20 h-20 object-cover rounded-lg"
                                />
                                <div>
                                    <h3 className="font-semibold text-gray-900">{meeting.gemName}</h3>
                                    <p className="text-sm text-gray-600">{meeting.gemType}</p>
                                    <p className="text-lg font-bold text-green-600 mt-1">
                                        {formatCurrency(meeting.finalPrice)}
                                    </p>
                                </div>
                            </div>
                            <div className="text-right">
                                <span className={`status-badge status-${meeting.status.toLowerCase()}`}>
                                    {meeting.status}
                                </span>
                                <p className="text-sm text-gray-600 mt-2">
                                    <span className="font-medium">Meeting with:</span><br />
                                    {isSeller ? meeting.buyerName : meeting.sellerName}
                                </p>
                            </div>
                        </div>

                        {/* Meeting Details */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div className="flex items-center space-x-2">
                                <Calendar className="w-4 h-4 text-gray-400" />
                                <span className="text-sm text-gray-600">{datetime.date}</span>
                            </div>
                            <div className="flex items-center space-x-2">
                                <Clock className="w-4 h-4 text-gray-400" />
                                <span className="text-sm text-gray-600">{datetime.time}</span>
                            </div>
                            <div className="flex items-center space-x-2">
                                <MapPin className="w-4 h-4 text-gray-400" />
                                <span className="text-sm text-gray-600">{meeting.location}</span>
                            </div>
                        </div>

                        {/* Contact Information - Hidden for privacy */}
                        {meeting.status === 'CONFIRMED' && (
                            <div className="bg-amber-50 rounded-lg p-4 mb-4 border border-amber-200">
                                <div className="flex items-center space-x-2">
                                    <AlertTriangle className="w-5 h-5 text-amber-600" />
                                    <h4 className="font-medium text-amber-800">Meeting Coordination</h4>
                                </div>
                                <p className="text-sm text-amber-700 mt-2">
                                    For privacy and security, all meeting coordination and contact exchange 
                                    must be handled through the admin team. The admin will facilitate 
                                    communication between both parties for this confirmed meeting.
                                </p>
                                <div className="mt-3 text-xs text-amber-600">
                                    <span className="font-medium">Meeting ID:</span> {meeting.meetingDisplayId || meeting.id.slice(-8)}
                                </div>
                            </div>
                        )}

                        {/* Notes */}
                        {(meeting.buyerNotes || meeting.sellerNotes) && (
                            <div className="bg-blue-50 rounded-lg p-4 mb-4">
                                <h4 className="font-medium text-gray-900 mb-2">Notes</h4>
                                {meeting.buyerNotes && (
                                    <div className="mb-2">
                                        <span className="text-sm font-medium text-gray-700">Buyer: </span>
                                        <span className="text-sm text-gray-600">{meeting.buyerNotes}</span>
                                    </div>
                                )}
                                {meeting.sellerNotes && (
                                    <div>
                                        <span className="text-sm font-medium text-gray-700">Seller: </span>
                                        <span className="text-sm text-gray-600">{meeting.sellerNotes}</span>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                );
            };

            return (
                <div className="test-container">
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                        <h1 className="text-2xl font-bold text-gray-900 mb-4">
                            🔒 Meeting Contact Privacy Test
                        </h1>
                        <p className="text-gray-600 mb-4">
                            Testing that contact information (email/phone) is hidden from both buyers and sellers 
                            for security and privacy. Only admin should see contact details.
                        </p>
                        
                        {/* View Toggle */}
                        <div className="flex items-center space-x-4 mb-6">
                            <span className="text-sm font-medium text-gray-700">View as:</span>
                            <div className="flex rounded-md overflow-hidden border border-gray-300">
                                <button
                                    onClick={() => setViewType('buyer')}
                                    className={`px-4 py-2 text-sm font-medium ${
                                        viewType === 'buyer'
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-white text-gray-700 hover:bg-gray-50'
                                    }`}
                                >
                                    👤 Buyer Dashboard
                                </button>
                                <button
                                    onClick={() => setViewType('seller')}
                                    className={`px-4 py-2 text-sm font-medium border-l border-gray-300 ${
                                        viewType === 'seller'
                                            ? 'bg-green-600 text-white'
                                            : 'bg-white text-gray-700 hover:bg-gray-50'
                                    }`}
                                >
                                    🏪 Seller Dashboard
                                </button>
                            </div>
                        </div>

                        {/* Test Results */}
                        <div className="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                            <div className="flex items-center space-x-2">
                                <CheckCircle className="w-5 h-5 text-green-600" />
                                <h3 className="font-medium text-green-800">✅ Privacy Protection Active</h3>
                            </div>
                            <ul className="mt-2 text-sm text-green-700 space-y-1">
                                <li>• Contact details are hidden from both buyers and sellers</li>
                                <li>• Admin-facilitated communication message is shown instead</li>
                                <li>• Meeting ID provided for admin reference</li>
                                <li>• Privacy notice explains the security policy</li>
                            </ul>
                        </div>
                    </div>

                    {/* Meeting Cards */}
                    <div className="space-y-4">
                        <h2 className="text-xl font-semibold text-gray-900">
                            {viewType === 'buyer' ? '👤 Buyer View' : '🏪 Seller View'} - Meetings
                        </h2>
                        {mockMeetings.map(meeting => renderMeetingCard(meeting))}
                    </div>

                    {/* Expected vs Actual Comparison */}
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mt-6">
                        <h3 className="text-lg font-semibold text-gray-900 mb-4">
                            🔍 Privacy Implementation Verification
                        </h3>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                                <h4 className="font-medium text-red-800 mb-2">❌ Before (Security Risk)</h4>
                                <ul className="text-sm text-red-700 space-y-1">
                                    <li>• Buyers could see seller email/phone</li>
                                    <li>• Sellers could see buyer email/phone</li>
                                    <li>• Direct communication bypassed admin</li>
                                    <li>• Potential for business outside platform</li>
                                </ul>
                            </div>
                            
                            <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                                <h4 className="font-medium text-green-800 mb-2">✅ After (Secure)</h4>
                                <ul className="text-sm text-green-700 space-y-1">
                                    <li>• No contact details visible to users</li>
                                    <li>• Admin-facilitated communication only</li>
                                    <li>• Clear privacy policy message</li>
                                    <li>• Meeting ID for admin reference</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ContactPrivacyTest />, document.getElementById('root'));
    </script>
</body>
</html>